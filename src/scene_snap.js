class Snap extends Scene{constructor(){super(),this.reset()}draw(){background(255),this.song_started||(this.startSong(snap),this.song_started=!0),Game.hits.length>0&&(this.safe_shapes=[]),Game.shapes=this.shapes,Game.shapes.forEach(((a,e)=>{a.update(),a.draw(),this.transition.alpha>5||Game.bug.pos.x>this.current_safe_shape.x&&Game.bug.pos.x<this.current_safe_shape.x+this.current_safe_shape.w&&Game.bug.pos.y>this.current_safe_shape.y&&Game.bug.pos.y<this.current_safe_shape.y+this.current_safe_shape.y||this.createCollision(a,e)})),this.safe_shapes.forEach(((a,e)=>{a.update(),a.draw(),null!=a.current||a.q.length||(this.safe_shapes.shift(),this.current_safe_shape=this.safe_shapes[0])})),this.transition.update(),this.transition.draw(),this.transition.q.length||this.song_stopped||(this.endSong(),this.song_stopped=!0),null!=this.transition.current||this.transition.q.length||(this.saveProgress("Outro"),this.endScene())}reset(){this.song_started=!1,this.song_stopped=!1,this.shapes=[],this.safe_shapes=[];const a=Game.width/16,e=Game.height/16;for(let s=0;s<e;s++)for(let h=0;h<a;h++)this.shapes.push(new Poly({x:h*a,y:s*e,w:a,h:e,color:"#fffc00"},[{delay:0,duration:0,props:{}}]));this.safe_shapes.push(new Poly({x:random(0,Game.width-144),y:random(0,Game.height-48),w:144,h:48,color:255,alpha:.01},[{delay:0,duration:0,props:{alpha:255}},{delay:11e3,duration:0,props:{alpha:0}}])),this.safe_shapes.push(new Poly({x:random(0,Game.width-56),y:random(0,Game.height-56),w:56,h:56,shape:"ellipse",color:255,alpha:.01},[{delay:11e3,duration:0,props:{alpha:255}},{delay:11e3,duration:0,props:{alpha:0}}])),this.safe_shapes.push(new Poly({x:random(0,Game.width-32),y:random(0,Game.height-32),w:32,h:32,color:255,alpha:.01},[{delay:22e3,duration:0,props:{alpha:255}},{delay:11e3,duration:0,props:{alpha:0}}])),this.safe_shapes.push(new Poly({x:random(0,Game.width-72),y:random(0,Game.height-72),w:72,h:72,shape:"triangle",color:255,alpha:.01},[{delay:33e3,duration:0,props:{alpha:255}},{delay:11e3,duration:0,props:{alpha:0}}])),this.safe_shapes.push(new Poly({x:random(0,Game.width-24),y:random(0,Game.height-24),w:24,h:24,color:255,alpha:.01},[{delay:44e3,duration:0,props:{alpha:255}},{delay:11e3,duration:0,props:{alpha:0}}])),this.transition=new Poly({x:0,y:0,w:Game.width,h:Game.height,color:255},[this.startBuffer(),{delay:0,duration:2e3,props:{alpha:0}},{delay:5e3,duration:2e3,props:{alpha:255}},{delay:2e3,duration:2e3,props:{alpha:0}},{delay:5e3,duration:2e3,props:{alpha:255}},{delay:2e3,duration:2e3,props:{alpha:0}},{delay:5e3,duration:2e3,props:{alpha:255}},{delay:2e3,duration:2e3,props:{alpha:0}},{delay:5e3,duration:2e3,props:{alpha:255}},{delay:2e3,duration:2e3,props:{alpha:0}},{delay:5e3,duration:2e3,props:{alpha:255}},this.endBuffer()]),this.current_safe_shape=this.safe_shapes[0]}}
